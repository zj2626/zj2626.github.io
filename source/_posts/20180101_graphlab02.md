---
title: Python 使用Graphlab构建分类模型-评价系统(待完成)

comments: true

tags:
    - python
    - 机器学习

categories:
    - 机器学习

description:

toc: true
   
---


<!--more-->

## 个人代码：

```python

# -*- coding: utf-8 -*-
# version python2.7
#  构建分类模型-电影评价情感分类器

# 下面注释的代码不能使用,使用便报错: No such file or directory
# import sys
# reload(sys)  
# sys.setdefaultencoding('utf8')

import graphlab
import numpy as np

#读取电影的评价信息
comments = graphlab.SFrame('GraphLabData/Data2.csv')

# 对每个评价建立单词计数向量
comments['word_count'] = graphlab.text_analytics.count_words(comments['comment'])
# comments.head()

# 查看文件中电影的分布情况
# comments['﻿name'].show()

# 观察某一个电影的评价进行分析: 获取数据集中满足name为'芳华'的数据,赋值给movie_reviews
movie_reviews = comments[comments['﻿name'] == '芳华']
# print (movie_reviews)

# 构建情感分类器
# comments['score'].show(view = 'Categorical')

# 定义正面评价和负面评论: 按照评分判断是正面还是负面,首先要去除中性的评分--30 (满分50)
comments = comments[comments['score'] != 30]
# print (len(comments))

# 正面评价
comments['sentiment'] = comments['score']  > 30
print (comments)

# 训练情感分类器
train_data, test_data = comments.random_split(.8, seed = 0)
comment_model = graphlab.logistic_classifier.create(train_data, target = 'sentiment', features = ['word_count'], validation_set = test_data)

# 进行了6次迭代

# 评估情感模型  ROC曲线
comment_model.evaluate(test_data, metric = 'roc_curve')
comment_model.show(view = 'Evaluation')

# 应用模型理解情感
movie_reviews['predicted_sentiment'] = comment_model.predict(movie_reviews, output_type = 'probability')
# 对预测的情感进行排序(False:降序)
movie_reviews = movie_reviews.sort('predicted_sentiment', ascending = False)
# 展示情感预测
movie_reviews.head()

# 查看评论
print (movie_reviews[0]['comment']) # 最好
print (movie_reviews[-1]['comment']) # 最不好

```


### 遇到的问题: 

> 如果报错: Runtime Exception. Column name XXXX does not exist. 解决方法: 先写comments.head()展示出文件中的部分数据,然后点击你需要的列的"表头"进行复制使用即可(复制的和写的可能不同)

{% qnimg 20180101221403.png title:问题 alt:问题 extend:?imageView2/2/w/600 %}

* 手写报错表头:

{% qnimg 20180101222023.png title:问题 alt:问题 extend:?imageView2/2/w/600 %}

* 复制的表头,并去除空格: (但是实际上如果你再次把该文本复制到任何其他地方,比如浏览器地址里其实和原来的一摸一样, 所以我也不知道为什么.2333)

{% qnimg 20180101222056.png title:问题 alt:问题 extend:?imageView2/2/w/600 %}


> 源文件: http://p18j2ow6f.bkt.clouddn.com/static/code/machine_learning/FLMX.ipynb
> 评价数据源文件: http://p18j2ow6f.bkt.clouddn.com/static/code/machine_learning/GraphLabData/Data2.csv

> 个人博客 欢迎来访： http://blog.zj2626.com